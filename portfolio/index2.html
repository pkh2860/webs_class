<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="assets/css/reset.css" />
    <link rel="stylesheet" href="assets/css/common.css" />
    <link rel="stylesheet" href="assets/css/fonts.css" />
    <link rel="stylesheet" href="assets/css/style2.css" />
    <link rel="stylesheet" href="assets/css/slider.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Jura:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <style>
      #about {
        height: 60vw;
      }
      .about__text {
        padding-bottom: 15vh;
      }
      .about__cont {
        width: 100%;
      }
      .about__cont h2 {
        color: #3c6b56;
        font-size: 15vw;
        /* font-size: 25vh; */
        line-height: 1.3;
        font-weight: 100;
        font-family: "Partizeno";
      }
      .about__cont p {
        line-height: 1.6;
        font-weight: 100;
        color: #3c6b56;
        font-size: 2vh;
        font-family: "ChosunNm";
      }
      .about__wrap {
        display: flex;
        align-items: center;
        justify-content: center;
        overflow: hidden;
      }
      .about__inner:nth-child(1) .about {
        margin: 0 auto;
        margin-left: 1vw;
      }
      .about__img {
        /*화면 보이는 구간*/
        position: relative;
        width: 800px;
        height: 320px;
      }
      .about__inner {
        /*이미지 움직이는 영역*/
        position: relative;
        display: flex;
        width: 2400px; /*이미지 총 길이*/
        left: -800px;
      }
      .about__inner.transition {
        transition: all 600ms;
      }
      .about {
        width: 800px;
        position: relative;
      }
    </style>
  </head>
  <body>
    <div>
      <header id="header">
        <nav id="nav">
          <a class="menu-trigger" href="#">
            <span></span>
            <span></span>
            <span></span>
          </a>
          <ul class="">
            <li><a href="#">ABOUT</a></li>
            <li><a href="#">WORK</a></li>
            <li><a href="#">CODE</a></li>
            <li><a href="#">SCRIPT</a></li>
            <li><a href="#">CONTACT</a></li>
          </ul>
        </nav>
      </header>

      <main>
        <section id="banner">
          <canvas id="canvas_bg"></canvas>
          <div class="banner__text">
            <h1><em>portfolio</em> <strong>2022</strong></h1>
            <p>
              welcome to my portfolio <br />
              We will become a developing frontend
            </p>
          </div>
        </section>

        <section id="about">
          <div class="about__cont">
            <div class="container">
              <div class="about__text">
                <h2>About</h2>
                <p>
                  안녕하세요 신입 웹퍼블리셔/프론트엔드 개발자 박근혁입니다.
                  처음에는 코딩의 코자도 모르고 알지도 못하는것에 도전하는것이
                  <br />많이 낯설고 무서웠습니다 그래도 용기를 내서 국비지원
                  학원을 알아보고 바로 다니기 시작했습니다<br />
                  처음에는 알지도 못하는 언어들이 나오고 이 일을 정말 할 수
                  있을까 의문이 들었지만 하다가 오류가 나면 앉은 자리에서
                  시간가는줄 모르고
                  <br />틀린 부분을 고치면 뿌듯함이 느껴졌습니다 배움은 조금
                  느려도 포기하지 않고 알아보려고 노력하였습니다.<br />
                  짧으면 짧고 길면 긴 6개월이 저에게는 너무나 짧게 느껴졌고 아직
                  배움이 부족하다고 생각합니다.<br />
                  앞으로도 계속 발전하고 노력하는 개발자가 되겠습니다.
                </p>
              </div>
            </div>
            <!-- 슬라이드 -->
            <div class="carousel">
              <div class="carousel--wrap">
                <div class="carousel--item">
                  <figure>
                    <img src="assets/img/img02.jpg" alt="" />
                  </figure>
                </div>

                <div class="carousel--item">
                  <figure>
                    <img src="assets/img/img02.jpg" alt="" />
                  </figure>
                </div>

                <div class="carousel--item">
                  <figure>
                    <img src="assets/img/img02.jpg" alt="" />
                  </figure>
                </div>
              </div>
              <div class="carousel--progress">
                <div class="carousel--progress-bar"></div>
              </div>
            </div>
            <!-- <div class="about__wrap">
              <div class="about__img">
                <div class="about__inner">
               
                    <div class="about s1">
                      <img src="assets/img/img02.jpg" alt="이미지1" />
                    </div>
                    <div class="about s2">
                      <img src="assets/img/img03.jpg" alt="이미지2" />
                    </div>
          

               
                  <div class="about s3">
                    <img src="assets/img/img04.jpg" alt="이미지3" />
                  </div>
      
                </div>
              </div> -->
          </div>
        </section>
      </main>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.10.4/gsap.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script>
      const Menu = document.querySelector("#nav ul");

      // 메뉴
      var burger = $(".menu-trigger");

      burger.each(function (index) {
        var $this = $(this);

        $this.on("click", function (e) {
          e.preventDefault();
          Menu.classList.toggle("active");
          $(this).toggleClass("active-" + (index + 1));
        });
      });

      document.querySelectorAll(".banner__text em").forEach((desc) => {
        let splitText = desc.innerText;
        let splitWrap = splitText
          .split("")
          .join("</span><span aria-hidden='true'>");
        splitWrap = "<span aria-hidden='true'>" + splitWrap + "</span>";
        desc.innerHTML = splitWrap;
        desc.setAttribute("aria-label", splitText);
      });

      gsap.set(".banner__text h1 em span", { opacity: 0, y: 20 });
      gsap.set(".banner__text strong", { opacity: 0 });
      gsap.set(".banner__text p", { opacity: 0 });
      gsap.set("#header", { opacity: 0, top: -100 });
      gsap.set("#canvas_bg", { opacity: 0 });

      setTimeout(() => {
        const tl = gsap.timeline();
        tl.to(".banner__text h1 em span", {
          duration: 0.6,
          stagger: 0.1,
          y: 0,
          autoAlpha: 1,
          ease: "power2.out",
        });
        tl.to(".banner__text strong", { duration: 0.3, autoAlpha: 1 });
        tl.to(".banner__text p", {
          duration: 0.3,
          autoAlpha: 1,
          ease: "power2.out",
        });
        tl.to("#header", { duration: 0.3, autoAlpha: 1, top: 0 });
        tl.to("#canvas_bg", { duration: 0.3, autoAlpha: 1 });
      }, 2000);

      var canvas = document.getElementById("canvas_bg");
      var ctx = canvas.getContext("2d");
      var cw = (canvas.width = window.innerWidth),
        cx = cw / 2;
      var ch = (canvas.height = window.innerHeight),
        cy = ch / 2;

      ctx.fillStyle = "#3C6B56";
      var circlesRy = [];
      var circlesNum = 5;
      var requestId = null;
      function Circle() {
        this.r = randomIntFromInterval(300, 300);
        this.x = randomIntFromInterval(this.r, cw - this.r);
        this.y = randomIntFromInterval(this.r, ch - this.r);

        this.vx = randomIntFromInterval(25, 100) / 100;
        this.vy = randomIntFromInterval(25, 100) / 100;

        this.update = function () {
          this.edges();
          this.x += this.vx;
          this.y += this.vy;
        };

        this.edges = function () {
          if (this.x < this.r || this.x > cw - this.r) {
            this.vx *= -1;
          }
          if (this.y < this.r || this.y > ch - this.r) {
            this.vy *= -1;
          }
        };

        this.draw = function () {
          ctx.strokeStyle = "#ccc";
          ctx.beginPath();
          ctx.arc(this.x, this.y, this.r, 0, 2 * Math.PI);
          ctx.stroke();
        };
      }

      for (var i = 0; i < circlesNum; i++) {
        var circle = new Circle();
        circlesRy.push(circle);
      }

      function Draw() {
        requestId = window.requestAnimationFrame(Draw);
        ctx.clearRect(0, 0, cw, ch);
        for (var i = 0; i < circlesRy.length; i++) {
          var c = circlesRy[i];
          c.update();
          c.draw();
        }
        for (var i = 0; i < circlesRy.length; i++) {
          var c = circlesRy[i];
          for (var j = i + 1; j < circlesRy.length; j++) {
            var c1 = circlesRy[j];
            var d = dist(c, c1);
            if (d < c.r + c1.r && d > Math.abs(c.r - c1.r)) {
              getIntersection(c, c1, d);
            }
          }
        }
      }

      function Init() {
        circlesRy.length = 0;
        for (var i = 0; i < circlesNum; i++) {
          var circle = new Circle();
          circlesRy.push(circle);
        }

        if (requestId) {
          window.cancelAnimationFrame(requestId);
          requestId = null;
        }

        (cw = canvas.width = window.innerWidth), (cx = cw / 2);
        (ch = canvas.height = window.innerHeight), (cy = ch / 2);

        Draw();
      }

      setTimeout(function () {
        Init();

        addEventListener("resize", Init, false);
      }, 15);

      function getIntersection(p1, p2, d) {
        var p3 = {}; // middle point
        var p4 = {}; // intersection 1
        var p5 = {}; // intersection 2

        var a =
          (Math.pow(p1.r, 2) - Math.pow(p2.r, 2) + Math.pow(d, 2)) / (2 * d);
        var h = Math.sqrt(Math.pow(p1.r, 2) - Math.pow(a, 2));

        p3.x = p1.x + (a * (p2.x - p1.x)) / d;
        p3.y = p1.y + (a * (p2.y - p1.y)) / d;

        p4.x = p3.x + (h * (p2.y - p1.y)) / d;
        p4.y = p3.y - (h * (p2.x - p1.x)) / d;

        p5.x = p3.x - (h * (p2.y - p1.y)) / d;
        p5.y = p3.y + (h * (p2.x - p1.x)) / d;

        markPoint(p4);
        markPoint(p5);
      }

      function dist(p1, p2) {
        var dx = p2.x - p1.x;
        var dy = p2.y - p1.y;
        return Math.sqrt(dx * dx + dy * dy);
      }

      function randomIntFromInterval(mn, mx) {
        return ~~(Math.random() * (mx - mn + 1) + mn);
      }

      function markPoint(p) {
        ctx.fillStyle = "#3C6B56";
        ctx.beginPath();
        ctx.arc(p.x, p.y, 2, 0, 2 * Math.PI);
        ctx.fill();
      }

      // 슬라이드
      const lerp = (f0, f1, t) => (1 - t) * f0 + t * f1;
      // const clamp = (val, min, max) => Math.max(min, Math.min(val, max));

      class DragScroll {
        constructor(obj) {
          this.$el = document.querySelector(obj.el);
          this.$wrap = this.$el.querySelector(obj.wrap);
          this.$items = this.$el.querySelectorAll(obj.item);
          this.$bar = this.$el.querySelector(obj.bar);
          this.init();
        }

        init() {
          this.progress = 0;
          this.speed = 0;
          this.oldX = 0;
          this.x = 0;
          this.playrate = 0;
          //
          this.bindings();
          this.events();
          this.calculate();
          this.raf();
        }

        bindings() {
          [
            "events",
            "calculate",
            "raf",
            // "handleWheel",
            "move",
            "raf",
            "handleTouchStart",
            "handleTouchMove",
            "handleTouchEnd",
          ].forEach((i) => {
            this[i] = this[i].bind(this);
          });
        }

        calculate() {
          this.progress = 0;
          this.wrapWidth = this.$items[0].clientWidth * this.$items.length;
          this.$wrap.style.width = `${this.wrapWidth}px`;
          this.maxScroll = this.wrapWidth - this.$el.clientWidth;
        }

        // handleWheel(e) {
        //   this.progress += e.deltaY;
        //   this.move();
        // }

        handleTouchStart(e) {
          e.preventDefault();
          this.dragging = true;
          this.startX = e.clientX || e.touches[0].clientX;
          this.$el.classList.add("dragging");
        }

        handleTouchMove(e) {
          if (!this.dragging) return false;
          const x = e.clientX || e.touches[0].clientX;
          this.progress += (this.startX - x) * 2.5;
          this.startX = x;
          this.move();
        }

        handleTouchEnd() {
          this.dragging = false;
          this.$el.classList.remove("dragging");
        }

        move() {
          this.progress = clamp(this.progress, 0, this.maxScroll);
        }

        events() {
          window.addEventListener("resize", this.calculate);
          // window.addEventListener("wheel", this.handleWheel);
          //
          this.$el.addEventListener("touchstart", this.handleTouchStart);
          window.addEventListener("touchmove", this.handleTouchMove);
          window.addEventListener("touchend", this.handleTouchEnd);
          //
          window.addEventListener("mousedown", this.handleTouchStart);
          window.addEventListener("mousemove", this.handleTouchMove);
          window.addEventListener("mouseup", this.handleTouchEnd);
          document.body.addEventListener("mouseleave", this.handleTouchEnd);
        }

        raf() {
          // requestAnimationFrame(this.raf)
          this.x = lerp(this.x, this.progress, 0.1);
          this.playrate = this.x / this.maxScroll;
          //
          this.$wrap.style.transform = `translateX(${-this.x}px)`;
          this.$bar.style.transform = `scaleX(${0.18 + this.playrate * 0.82})`;
          //
          this.speed = Math.min(100, this.oldX - this.x);
          this.oldX = this.x;
          //
          this.scale = lerp(this.scale, this.speed, 0.1);
          this.$items.forEach((i) => {
            i.style.transform = `scale(${1 - Math.abs(this.speed) * 0.002})`;
            i.querySelector("img").style.transform = `scaleX(${
              1 + Math.abs(this.speed) * 0.004
            })`;
          });
        }
      }

      /*--------------------
Instances
--------------------*/
      const scroll = new DragScroll({
        el: ".carousel",
        wrap: ".carousel--wrap",
        item: ".carousel--item",
        bar: ".carousel--progress-bar",
      });

      /*--------------------
One raf to rule em all
--------------------*/
      const raf = () => {
        requestAnimationFrame(raf);
        scroll.raf();
      };
      raf();
    </script>
  </body>
</html>
